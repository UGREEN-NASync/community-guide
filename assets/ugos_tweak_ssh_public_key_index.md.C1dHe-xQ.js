import{_ as e,c as i,a2 as a,o as t}from"./chunks/framework.C57abF2z.js";const k=JSON.parse('{"title":"Use public key authentication for ssh instead of password","description":"","frontmatter":{},"headers":[],"relativePath":"ugos/tweak/ssh_public_key/index.md","filePath":"ugos/tweak/ssh_public_key/index.md"}'),n={name:"ugos/tweak/ssh_public_key/index.md"};function o(h,s,r,p,l,c){return t(),i("div",null,s[0]||(s[0]=[a(`<h1 id="use-public-key-authentication-for-ssh-instead-of-password" tabindex="-1">Use public key authentication for ssh instead of password <a class="header-anchor" href="#use-public-key-authentication-for-ssh-instead-of-password" aria-label="Permalink to &quot;Use public key authentication for ssh instead of password&quot;">​</a></h1><p>Usually, setting up key based authentication for a SSH server is as simple as a single call to <a href="https://manpages.debian.org/bookworm/openssh-client/ssh-copy-id.1.en.html" target="_blank" rel="noreferrer">ssh-copy-id</a>. However, on UGOS, there are some extra steps required to fix the permission issues.</p><h2 id="instructions" tabindex="-1">Instructions <a class="header-anchor" href="#instructions" aria-label="Permalink to &quot;Instructions&quot;">​</a></h2><p>To fix the SSH permissions, we need to define a new system service. First, you need to log in via SSH:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> USERNAME@IP</span></span></code></pre></div><p>When asked for a password, use your account password.</p><p>Next, create a new file for the script</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/check_and_fix_ssh_permissions.sh</span></span></code></pre></div><p>and paste the content of <a href="https://raw.githubusercontent.com/UGREEN-NASync/community-guide/refs/heads/main/docs/ugos/tweak/ssh_public_key/check_and_fix_ssh_permissions.sh" target="_blank" rel="noreferrer">check_and_fix_ssh_permissions.sh</a> inside. Make sure to replace <code>&lt;USER NAME&gt;</code> with you actual username.</p><p>Next, create the service file</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/ssh-permission-monitor.service</span></span></code></pre></div><p>and paste the content of <a href="https://github.com/UGREEN-NASync/community-guide/blob/main/docs/ugos/tweak/ssh_public_key/ssh-permission-monitor.service" target="_blank" rel="noreferrer">ssh-permission-monitor.service</a> inside. Again, replace <code>&lt;USER NAME&gt;</code> with you actual username.</p><p>Now reload the systemctl daemon:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre></div><p>And enable and start the service:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh-permission-monitor.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh-permission-monitor.service</span></span></code></pre></div><p>You can also look at the service status and troublshoot issues:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh-permission-monitor.service</span></span></code></pre></div><p>After those steps, your key should be accepted even after system reboots or configuration changes through the UGOS web interface.</p><div class="info custom-block"><p class="custom-block-title">Credit</p><p>This guide was originally created by <a href="https://www.reddit.com/user/RealMrCr4cker/" target="_blank" rel="noreferrer">RealMrCr4cker</a> (<a href="https://github.com/ln-12/UGOS_scripts/" target="_blank" rel="noreferrer">Github repo</a>) and is under an MIT Licence</p></div>`,20)]))}const u=e(n,[["render",o]]);export{k as __pageData,u as default};
